<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flood Prediction Dashboard</title>
    <link rel="stylesheet" href="flood-style.css">
</head>
<body>
    <div class="dashboard-container">
        <header>
            <h1>üåä Flood Prediction System üåä</h1>
            <p>Real-time flood risk estimation for the next three hours</p>
        </header>

        <!-- Logout Button -->
        <div style="text-align: right;">
            <button style="background-color: #ff0066; color: white; padding: 10px; border: none; border-radius: 5px; cursor: pointer;"
                    onclick="window.location.href='/logout'">
                Logout
            </button>
        </div>

        <div class="image-container">
            <img src="Images/flood_alert.png" alt="Flood Alert Visualization" width="20%">
        </div>

        <section class="input-section">
            <h2>Enter Real-Time Data</h2>
            <label for="discharge">üîÑ Discharge Rate (cumecs):</label>
            <input type="number" id="discharge" name="discharge" step="0.01" required>

            <label for="rainfall">üåßÔ∏è Rainfall (mm):</label>
            <input type="number" id="rainfall" name="rainfall" step="0.01" required>

            <label for="waterlevel">üìè Water Level (m):</label>
            <input type="number" id="waterlevel" name="waterlevel" step="0.01" required>
            
            <button style="margin-top: 10px; padding: 10px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;"
                    onclick="handlePredict()">
                Predict
            </button>
        </section>

        <section id="result">
            <h3>üìä Predicted Water Levels</h3>
            <div class="prediction-container">
                <p><strong>Next 1 Hour:</strong> <span id="hour1">--</span></p>
                <p><strong>Next 2 Hours:</strong> <span id="hour2">--</span></p>
                <p><strong>Next 3 Hours:</strong> <span id="hour3">--</span></p>
            </div>

            <h3>‚ö†Ô∏è Flood Alerts</h3>
            <div class="alert-container">
                <p><span id="alert1">Waiting for input...</span></p>
                <p><span id="alert2"></span></p>
                <p><span id="alert3"></span></p>
            </div>
        </section>

        <footer>
            <p>üöÄ Stay Alert, Stay Safe</p>
        </footer>
    </div>

    <script>
        async function handlePredict() {
            const discharge = document.getElementById("discharge").value.trim();
            const rainfall = document.getElementById("rainfall").value.trim();
            const waterlevel = document.getElementById("waterlevel").value.trim();

            try {
                let response = await fetch("/predict", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        discharge_rate: discharge,
                        rainfall: rainfall,
                        water_level: waterlevel
                    })
                });
                let result = await response.json();

                document.getElementById("hour1").innerText = result["Next 1 Hour Water Level"]?.toFixed(2) ?? "--";
                document.getElementById("hour2").innerText = result["Next 2 Hours Water Level"]?.toFixed(2) ?? "--";
                document.getElementById("hour3").innerText = result["Next 3 Hours Water Level"]?.toFixed(2) ?? "--";

                document.getElementById("alert1").innerText = result["Alert 1"] ?? "";
                document.getElementById("alert2").innerText = result["Alert 2"] ?? "";
                document.getElementById("alert3").innerText = result["Alert 3"] ?? "";
            } catch (error) {
                console.error("Prediction error:", error);
                alert("Error making prediction. Check console for details.");
            }
        }
    </script>
</body>
</html>
