<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="/Frontend/CSS/Sign In-style.css"/>
    <title>FloodGuard - Sign In</title>
    <!-- Google Platform Library -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
    <div class="container">
        <div class="back-button">
            <a href="Page 1 file.html">‚Üê</a>
        </div>
        <h1>Sign In</h1>

        <div class="logo-container">
            <img src="Images/signinlogo.png" alt="Sign In Logo" class="logo"/>
        </div>
        
        <!-- Email/Password Inputs -->
        <div class="input-group">
            <label for="email">Email</label>
            <input type="email" id="email" placeholder="Email"/>
        </div>
        <div class="input-group">
            <label for="password">Password</label>
            <input type="password" id="password" placeholder="Password"/>
        </div>

        <!-- Sign In Button -->
        <button class="sign-in-btn" id="signin-btn">Sign In</button>

        <!-- Forgot Password Link -->
        <div class="forgot-password">
            <a href="Reset Password.html">Forgot Password?</a>
        </div>

        <!-- Google Sign-In -->
        <div class="google-sign-in">
            <div id="g_id_onload"
                data-client_id="YOUR_GOOGLE_CLIENT_ID"
                data-login_uri="http://localhost:5500"
                data-auto_prompt="false">
            </div>

            <div class="g_id_signin"
                data-type="standard"
                data-shape="rectangular"
                data-theme="outline"
                data-text="continue_with"
                data-size="large"
                data-logo_alignment="left">
            </div>
        </div>
    </div>

    <script>
        document.getElementById("signin-btn").addEventListener("click", async function(){
            const emailValue = document.getElementById("email").value.trim();
            const passwordValue = document.getElementById("password").value.trim();

            if(!emailValue || !passwordValue) {
                alert("Please fill in email and password.");
                return;
            }

            try {
                let response = await fetch("http://localhost:5000/signin", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ email: emailValue, password: passwordValue })
                });

                let result = await response.json();
                if (result.success) {
                    // Redirect to the main page (index.html)
                    window.location.href = "index.html"; 
                } else {
                    alert(result.message || "Invalid credentials.");
                }
            } catch (error) {
                console.error("Sign-in error:", error);
                alert("Error signing in. Please try again.");
            }
        });
    </script>
</body>
</html>
